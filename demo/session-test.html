<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
</head>
<body>
</body>
<script>

var initiator = new EventSource('http://localhost:3000/channel');
var responder;
var cid, key;
initiator.onopen = function(e) {
	console.log("initiator open");
}
initiator.addEventListener('channel', function(e) {
	var data = JSON.parse(e.data);
	cid = data.cid;
	key = data.key;
	console.log("channel", data);	
});
initiator.addEventListener('message', function(e) {
	console.log("message", JSON.parse(e.data));
});
initiator.onerror = function(e) {
	if (e.target.readyState == EventSource.CLOSED) {
    	// Connection was closed.
    	console.log("initiator closed");
    	return;
  	}
  	console.error(e);
}
	
</script>
</html>
